<?xml version="1.0" encoding="utf-8"?>

<odoo>
  <data>
    <template id="template_name" name="Custom Page">
      <t t-call="website.layout">
        <t t-set="logged_partner" t-value="request.env['website.visitor']._get_visitor_from_request().partner_id"/>
        <t t-set="contactus_form_values" t-value="{                 'email_to': res_company.email,                 'name': request.params.get('name', ''),                 'phone': request.params.get('phone', ''),                 'email_from': request.params.get('email_from', ''),                 'company': request.params.get('company', ''),                 'subject': request.params.get('subject', ''),             }"/>
        <span class="hidden" data-for="contactus_form" t-att-data-values="contactus_form_values"/>
        <div id="wrap" class="oe_structure oe_empty">
          <section class="s_title parallax s_parallax_is_fixed bg-black-50 pt24 pb24" data-vcss="001" data-snippet="s_title" data-scroll-background-ratio="1">
            <span class="s_parallax_bg oe_img_bg" style="background-image: url('/web/image/website.s_banner_default_image'); background-position: 50% 0;"/>
            <div class="o_we_bg_filter bg-black-50"/>
            <div class="container">
              <h1>Helpdesk Ticket</h1>
            </div>
          </section>
          <section class="s_text_block pt40 pb40 o_colored_level " data-snippet="s_text_block">
            <div class="container s_allow_columns">
              <div class="row">
                <div class="col-lg-8 mt-4 mt-lg-0">
                  <p>
                                    Enter following details
                  </p>
                  <section class="s_website_form" data-vcss="001" data-snippet="s_website_form">
                    <div class="container">
                      <form id="contactus_form" role="form" t-attrf-action="/ticket_created" method="POST">
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                        <div class="s_website_form_rows row s_col_no_bgcolor">
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom s_website_form_required" data-type="char" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact1">
                                <span class="s_website_form_label_content">Category</span>
                                <span class="s_website_form_mark"> *</span>
                              </label>

                              <t t-set="categories" t-value="request.env['helpdesk.category'].sudo().search([])"/>
                              <div class="col-sm">
                                <input type="text" id="category_input" class="form-control s_website_form_input" name="category" placeholder="Enter a Category" list="categories_list"/>
                                <datalist id="categories_list">
                                  <t t-foreach="categories" t-as="category">
                                    <option t-att-value="category.name"/>
                                  </t>
                                </datalist>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom" data-type="char" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact2">
                                <span class="s_website_form_label_content">Sub Category</span>
                              </label>

                              <t t-set="sub_categories" t-value="request.env['helpdesk.subcategory'].sudo().search([])"/>
                              <div class="col-sm">
                                <input type="text" id="sub_category_select" class="form-control s_website_form_input" name="sub_category" placeholder="Enter a Sub Category" list="sub_categories_list"/>
                                <datalist id="sub_categories_list">
                                  <t t-foreach="sub_categories" t-as="sub_category">
                                    <option t-att-value="sub_category.name"/>
                                  </t>
                                </datalist>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_required s_website_form_model_required" data-type="email" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact3">
                                <span class="s_website_form_label_content">Subject</span>
                                <span class="s_website_form_mark"> *</span>
                              </label>

                              <t t-set="subjects" t-value="request.env['helpdesk.sub.type'].sudo().search([])"/>
                              <div class="col-sm">
                                <input type="text" id="category_input" class="form-control s_website_form_input" name="category" placeholder="Enter a Category Name" list="categories_list"/>
                                <datalist id="categories_list">
                                  <t t-foreach="categories" t-as="category">
                                    <option t-att-value="category.name"/>
                                  </t>
                                </datalist>
                              </div>


                              <t t-set="subjects" t-value="request.env['helpdesk.sub.type'].sudo().search([])"/>
                              <div class="col-sm">
                                <select id="subject_select" class="form-control s_website_form_input" name="subject">
                                  <option value="">Select a Subject</option>
                                  <t t-foreach="subjects" t-as="subject">
                                    <option t-att-value="subject.id">
                                      <t t-esc="subject.name"/>
                                    </option>
                                  </t>
                                </select>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom" data-type="char" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <div class="col-sm">
                                <!-- Hidden field for Name, auto-populated with current user name -->
                                <input id="name_select" type="text" class="form-control s_website_form_input" name="name" style="display:none;" t-att-value="request.env['res.users'].sudo().search([], limit=1).name"/>
                              </div>
                            </div>
                          </div>
                          <!-- <t t-esc="request.env['res.users'].sudo().search([], limit=1).name"/> -->

                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_required s_website_form_model_required" data-type="char" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <div class="col-sm">
                                <!-- Hidden field for Email, auto-populated with current user email -->
                                <input id="email_select" type="text" class="form-control s_website_form_input" name="email" required="" style="display:none;" t-att-value="request.env['res.users'].sudo().search([], limit=1).email"/>
                              </div>
                            </div>
                          </div>
                          <!-- <t t-esc="request.env['res.users'].sudo().search([], limit=1).email"/> -->
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom s_website_form_required" data-type="text" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact6">
                                <span class="s_website_form_label_content">Description</span>
                                <span class="s_website_form_mark"> *</span>
                              </label>
                              <div class="col-sm">
                                <textarea id="description_select" class="form-control s_website_form_input" name="description" required=""/>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom s_website_form_required" data-type="text" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact6">
                                <span class="s_website_form_label_content">Priority</span>
                                <span class="s_website_form_mark"> *</span>
                              </label>
                              <t t-set="priorities" t-value="request.env['helpdesk.priority'].sudo().search([])"/>
                              <div class="col-sm">
                                <select id="priority_select" class="form-control s_website_form_input" name="priority">
                                  <option value="">Select Priority</option>
                                  <t t-foreach="priorities" t-as="priority">
                                    <option t-att-value="priority.id">
                                      <t t-esc="priority.name"/>
                                    </option>
                                  </t>
                                </select>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom s_website_form_required" data-type="text" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact6">
                                <span class="s_website_form_label_content">Project</span>
                                <span class="s_website_form_mark"> *</span>
                              </label>
                              <t t-set="projects" t-value="request.env['project.project'].sudo().search([])"/>
                              <div class="col-sm">
                                <select id="project_select" class="form-control s_website_form_input" name="project">
                                  <option value="">Select Project</option>
                                  <t t-foreach="projects" t-as="project">
                                    <option t-att-value="project.id">
                                      <t t-esc="project.name"/>
                                    </option>
                                  </t>
                                </select>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_field s_website_form_custom s_website_form_required" data-type="text" data-name="Field">
                            <div class="row s_col_no_resize s_col_no_bgcolor">
                              <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="contact6">
                                <span class="s_website_form_label_content">Attachments</span>
                                <span class="s_website_form_mark"> *</span>
                              </label>
                              <div class="form-group">
                                <input type="file" id="attachment_select" name="attachment" class="form-control"/>
                              </div>
                            </div>
                          </div>
                          <div class="mb-0 py-2 col-12 s_website_form_submit" data-name="Submit Button">
                            <button type="submit" class="btn btn-primary">Submit</button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </section>
                </div>
              </div>
            </div>
          </section>
        </div>
      </t>
    </template>

    <template id="success_page_template">
      <div class="alert alert-success" role="alert">
            Your ticket has been created successfully!
      </div>
    </template>


  </data>
</odoo>